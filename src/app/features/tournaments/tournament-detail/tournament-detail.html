@if (loading()) {
  <div class="text-center py-12 text-gray-500">A carregar torneio...</div>
} @else if (!tournament()) {
  <div class="text-center py-12">
    <p class="text-gray-500">Torneio nao encontrado.</p>
    <a routerLink="/tournaments" class="mt-2 inline-block text-blue-600 text-sm">Voltar a lista</a>
  </div>
} @else {
  <div class="space-y-6">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4">
      <div class="flex items-center gap-4">
        <a routerLink="/tournaments" class="text-gray-400 hover:text-gray-600 transition-colors">
          <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        </a>
        <div>
          <h1 class="text-2xl font-bold text-gray-900">{{ tournament()!.name }}</h1>
          <div class="mt-1 flex items-center gap-3">
            <span [class]="'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + getStatusClass(tournament()!.status)">
              {{ getStatusLabel(tournament()!.status) }}
            </span>
            <span class="text-sm text-gray-500">{{ getFormatLabel(tournament()!.format) }}</span>
            <span class="text-sm text-gray-400">{{ teams().length }}/{{ tournament()!.max_teams }} equipas</span>
          </div>
        </div>
      </div>

      <!-- Creator Actions -->
      @if (isCreator()) {
        <div class="flex gap-2 flex-wrap">
          @switch (tournament()!.status) {
            @case ('draft') {
              <button (click)="updateStatus('registration')"
                class="px-3 py-1.5 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors cursor-pointer">
                Abrir Inscricoes
              </button>
            }
            @case ('registration') {
              <button (click)="updateStatus('in_progress')"
                [disabled]="teams().length < 2 || generatingBracket()"
                class="px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">
                @if (generatingBracket()) {
                  A gerar bracket...
                } @else {
                  Iniciar Torneio
                }
              </button>
            }
            @case ('in_progress') {
              <button (click)="updateStatus('completed')"
                class="px-3 py-1.5 text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors cursor-pointer">
                Concluir
              </button>
            }
          }
          @if (tournament()!.status !== 'cancelled' && tournament()!.status !== 'completed') {
            <button (click)="updateStatus('cancelled')"
              class="px-3 py-1.5 text-sm font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors cursor-pointer">
              Cancelar
            </button>
          }
        </div>
      }
    </div>

    <!-- Register Button (for players) -->
    @if (canRegister() && !showRegisterForm()) {
      <div class="bg-green-50 border border-green-200 rounded-lg p-4 flex items-center justify-between">
        <p class="text-sm text-green-800">Inscricoes abertas! Regista a tua equipa para participar.</p>
        <button (click)="showRegisterForm.set(true)"
          class="px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors cursor-pointer">
          Inscrever Equipa
        </button>
      </div>
    }

    @if (isRegistered()) {
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
        <p class="text-sm text-blue-800">Ja estas inscrito neste torneio.</p>
      </div>
    }

    <!-- Team Registration Form -->
    @if (showRegisterForm()) {
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">Inscrever Equipa</h3>

        @if (registerError()) {
          <div class="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700">
            {{ registerError() }}
          </div>
        }

        <div class="space-y-4">
          <!-- Team Name (optional) -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Nome da Equipa (opcional)</label>
            <input type="text" [ngModel]="teamName()" (ngModelChange)="teamName.set($event)"
              placeholder="Ex: Os Invenciveis"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
          </div>

          <!-- Partner Search -->
          <div class="relative">
            <label class="block text-sm font-medium text-gray-700 mb-1">Parceiro</label>
            @if (selectedPartner()) {
              <div class="flex items-center gap-2 px-3 py-2 bg-blue-50 border border-blue-200 rounded-lg">
                <span class="text-sm text-blue-900 font-medium">{{ selectedPartner()!.full_name }}</span>
                <button (click)="clearPartner()" class="ml-auto text-blue-500 hover:text-blue-700 cursor-pointer">
                  <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            } @else {
              <input type="text" [ngModel]="partnerSearch()" (ngModelChange)="partnerSearch.set($event); searchPartner()"
                placeholder="Pesquisar jogador por nome..."
                class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />

              @if (partnerResults().length > 0) {
                <div class="absolute z-10 mt-1 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto">
                  @for (player of partnerResults(); track player.id) {
                    <button (click)="selectPartner(player)"
                      class="w-full text-left px-3 py-2 text-sm hover:bg-gray-50 cursor-pointer transition-colors">
                      <span class="font-medium text-gray-900">{{ player.full_name }}</span>
                      @if (player.skill_level) {
                        <span class="ml-2 text-xs text-gray-500">Nivel {{ player.skill_level }}</span>
                      }
                    </button>
                  }
                </div>
              }
            }
          </div>

          <!-- Actions -->
          <div class="flex gap-3 pt-2">
            <button (click)="registerTeam()"
              [disabled]="!selectedPartner() || registering()"
              class="px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">
              @if (registering()) {
                A inscrever...
              } @else {
                Confirmar Inscricao
              }
            </button>
            <button (click)="showRegisterForm.set(false); clearPartner(); teamName.set('')"
              class="px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors cursor-pointer">
              Cancelar
            </button>
          </div>
        </div>
      </div>
    }

    <!-- Tabs -->
    <div class="border-b border-gray-200">
      <nav class="flex space-x-8 overflow-x-auto">
        @for (tab of [
          { id: 'info', label: 'Informacao' },
          { id: 'teams', label: 'Equipas (' + teams().length + ')' },
          { id: 'matches', label: 'Jogos (' + matches().length + ')' },
          { id: 'standings', label: 'Classificacao' },
          { id: 'bracket', label: 'Bracket' }
        ]; track tab.id) {
          @if (tab.id !== 'bracket' || hasBracket()) {
            <button (click)="activeTab.set($any(tab.id))"
              [class]="activeTab() === tab.id
                ? 'border-blue-500 text-blue-600 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm cursor-pointer'
                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm cursor-pointer'">
              {{ tab.label }}
            </button>
          }
        }
      </nav>
    </div>

    <!-- Tab Content -->
    @switch (activeTab()) {
      <!-- INFO TAB -->
      @case ('info') {
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
            @if (tournament()!.description) {
              <div class="sm:col-span-2">
                <dt class="text-sm font-medium text-gray-500">Descricao</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.description }}</dd>
              </div>
            }
            <div>
              <dt class="text-sm font-medium text-gray-500">Formato</dt>
              <dd class="mt-1 text-sm text-gray-900">{{ getFormatLabel(tournament()!.format) }}</dd>
            </div>
            <div>
              <dt class="text-sm font-medium text-gray-500">Max. Equipas</dt>
              <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.max_teams }}</dd>
            </div>
            <div>
              <dt class="text-sm font-medium text-gray-500">Data de Inicio</dt>
              <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.start_date | date:'dd/MM/yyyy' }}</dd>
            </div>
            @if (tournament()!.end_date) {
              <div>
                <dt class="text-sm font-medium text-gray-500">Data de Fim</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.end_date | date:'dd/MM/yyyy' }}</dd>
              </div>
            }
            @if (tournament()!.location) {
              <div>
                <dt class="text-sm font-medium text-gray-500">Localizacao</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.location }}</dd>
              </div>
            }
            @if (tournament()!.organizer) {
              <div>
                <dt class="text-sm font-medium text-gray-500">Organizador</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.organizer!.full_name }}</dd>
              </div>
            }
            <div>
              <dt class="text-sm font-medium text-gray-500">Sets por Jogo</dt>
              <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.settings.sets_per_match }}</dd>
            </div>
            <div>
              <dt class="text-sm font-medium text-gray-500">Games por Set</dt>
              <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.settings.games_per_set }}</dd>
            </div>
            @if (tournament()!.format === 'groups_elimination') {
              <div>
                <dt class="text-sm font-medium text-gray-500">Numero de Grupos</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.settings.groups_count ?? '-' }}</dd>
              </div>
              <div>
                <dt class="text-sm font-medium text-gray-500">Qualificam por Grupo</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.settings.qualify_per_group ?? '-' }}</dd>
              </div>
            }
            @if (tournament()!.format === 'americano') {
              <div>
                <dt class="text-sm font-medium text-gray-500">Rondas Americano</dt>
                <dd class="mt-1 text-sm text-gray-900">{{ tournament()!.settings.americano_rounds ?? 'Auto' }}</dd>
              </div>
            }
          </dl>
        </div>
      }

      <!-- TEAMS TAB -->
      @case ('teams') {
        @if (teams().length === 0) {
          <div class="text-center py-8 text-gray-500">Nenhuma equipa inscrita.</div>
        } @else {
          <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">#</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Equipa</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Jogador 1</th>
                  <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Jogador 2</th>
                  @if (tournament()!.status === 'registration') {
                    <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Acoes</th>
                  }
                </tr>
              </thead>
              <tbody class="divide-y divide-gray-200">
                @for (team of teams(); track team.id; let i = $index) {
                  <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 text-sm text-gray-500">{{ team.seed || i + 1 }}</td>
                    <td class="px-6 py-4 text-sm font-medium text-gray-900">{{ team.name || '-' }}</td>
                    <td class="px-6 py-4 text-sm text-gray-700">
                      <a [routerLink]="['/players', team.player1_id]" class="hover:text-blue-600">
                        {{ team.player1?.full_name || '-' }}
                      </a>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-700">
                      <a [routerLink]="['/players', team.player2_id]" class="hover:text-blue-600">
                        {{ team.player2?.full_name || '-' }}
                      </a>
                    </td>
                    @if (tournament()!.status === 'registration') {
                      <td class="px-6 py-4 text-right">
                        @if (canRemoveTeam(team)) {
                          <button (click)="removeTeam(team.id)"
                            class="text-red-500 hover:text-red-700 text-sm cursor-pointer">
                            Remover
                          </button>
                        }
                      </td>
                    }
                  </tr>
                }
              </tbody>
            </table>
          </div>
        }
      }

      <!-- MATCHES TAB -->
      @case ('matches') {
        @if (matches().length === 0) {
          <div class="text-center py-8 text-gray-500">
            @if (tournament()!.status === 'registration' || tournament()!.status === 'draft') {
              Os jogos serao gerados quando o torneio iniciar.
            } @else {
              Nenhum jogo agendado.
            }
          </div>
        } @else {
          <div class="space-y-6">
            @for (roundEntry of matchesByRound(); track roundEntry[0]) {
              <div>
                <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3">
                  {{ getRoundLabel(roundEntry[0]) }}
                </h3>
                <div class="space-y-3">
                  @for (match of roundEntry[1]; track match.id) {
                    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
                      <div class="flex items-center justify-between">
                        <div class="flex items-center gap-2 text-xs text-gray-500">
                          <span>Jogo {{ match.match_number }}</span>
                          @if (match.court) {
                            <span>&middot;</span>
                            <span>Campo {{ match.court }}</span>
                          }
                          @if (match.scheduled_at) {
                            <span>&middot;</span>
                            <span>{{ match.scheduled_at | date:'dd/MM HH:mm' }}</span>
                          }
                        </div>
                        <div class="flex items-center gap-2">
                          <span [class]="'text-xs font-medium px-2 py-0.5 rounded-full ' + (
                            match.status === 'completed' ? 'bg-green-100 text-green-700' :
                            match.status === 'in_progress' ? 'bg-yellow-100 text-yellow-700' :
                            'bg-gray-100 text-gray-600')">
                            {{ getMatchStatusLabel(match.status) }}
                          </span>
                          @if (canScore(match)) {
                            <button (click)="openScoring(match)"
                              class="text-xs text-blue-600 hover:text-blue-800 font-medium cursor-pointer">
                              Registar Resultado
                            </button>
                          }
                        </div>
                      </div>

                      <div class="mt-3 flex items-center justify-between">
                        <div class="flex-1 text-center">
                          <p class="font-medium text-gray-900" [class.text-green-600]="match.winner_id === match.team1_id">
                            {{ getMatchTeamDisplay(match, 'team1') }}
                          </p>
                        </div>
                        <div class="px-4 text-gray-400 text-sm font-medium">vs</div>
                        <div class="flex-1 text-center">
                          <p class="font-medium text-gray-900" [class.text-green-600]="match.winner_id === match.team2_id">
                            {{ getMatchTeamDisplay(match, 'team2') }}
                          </p>
                        </div>
                      </div>

                      @if (match.sets && match.sets.length > 0) {
                        <div class="mt-2 flex justify-center gap-3">
                          @for (set of match.sets; track set.set_number) {
                            <span class="text-sm font-mono px-2 py-0.5 rounded"
                              [class]="set.team1_score > set.team2_score ? 'bg-green-50 text-green-700' :
                                set.team2_score > set.team1_score ? 'bg-red-50 text-red-700' : 'bg-gray-50 text-gray-600'">
                              {{ set.team1_score }}-{{ set.team2_score }}
                            </span>
                          }
                        </div>
                      }

                      <!-- Inline Score Entry -->
                      @if (scoringMatchId() === match.id) {
                        <div class="mt-4 pt-4 border-t border-gray-200">
                          <h4 class="text-sm font-medium text-gray-700 mb-3">Registar Resultado</h4>

                          @if (scoreError()) {
                            <div class="mb-3 p-2 bg-red-50 border border-red-200 rounded text-sm text-red-700">
                              {{ scoreError() }}
                            </div>
                          }

                          <div class="space-y-2">
                            @for (setScore of setScores(); track $index; let i = $index) {
                              <div class="flex items-center gap-3">
                                <span class="text-sm text-gray-500 w-12">Set {{ i + 1 }}</span>
                                <div class="flex items-center gap-2">
                                  <input type="number" min="0" max="99"
                                    [ngModel]="setScore.team1"
                                    (ngModelChange)="updateSetScore(i, 'team1', $event)"
                                    class="w-16 px-2 py-1 border border-gray-300 rounded text-center text-sm focus:ring-2 focus:ring-blue-500" />
                                  <span class="text-gray-400">-</span>
                                  <input type="number" min="0" max="99"
                                    [ngModel]="setScore.team2"
                                    (ngModelChange)="updateSetScore(i, 'team2', $event)"
                                    class="w-16 px-2 py-1 border border-gray-300 rounded text-center text-sm focus:ring-2 focus:ring-blue-500" />
                                </div>
                              </div>
                            }
                          </div>

                          <div class="flex gap-2 mt-3">
                            <button (click)="saveScore()"
                              [disabled]="savingScore()"
                              class="px-3 py-1.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors cursor-pointer disabled:opacity-50">
                              @if (savingScore()) {
                                A guardar...
                              } @else {
                                Guardar
                              }
                            </button>
                            <button (click)="closeScoring()"
                              class="px-3 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors cursor-pointer">
                              Cancelar
                            </button>
                          </div>
                        </div>
                      }
                    </div>
                  }
                </div>
              </div>
            }
          </div>
        }
      }

      <!-- STANDINGS TAB -->
      @case ('standings') {
        @if (standings().length === 0) {
          <div class="text-center py-8 text-gray-500">
            @if (tournament()!.status === 'registration' || tournament()!.status === 'draft') {
              A classificacao ficara disponivel apos o inicio do torneio.
            } @else {
              Sem dados de classificacao.
            }
          </div>
        } @else {
          <div class="space-y-6">
            <!-- Group standings (if groups exist) -->
            @if (groups().length > 0) {
              @for (group of groups(); track group.id) {
                <div>
                  <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide mb-3">{{ group.name }}</h3>
                  <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200">
                      <thead class="bg-gray-50">
                        <tr>
                          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Pos</th>
                          <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Equipa</th>
                          <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">J</th>
                          <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">V</th>
                          <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">D</th>
                          <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Sets</th>
                          <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Games</th>
                          <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Pts</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200">
                        @for (standing of getGroupStandings(group.id); track standing.id; let i = $index) {
                          <tr [class]="i < (tournament()!.settings.qualify_per_group ?? 2) ? 'bg-green-50' : ''">
                            <td class="px-4 py-2 text-sm text-gray-600">{{ i + 1 }}</td>
                            <td class="px-4 py-2 text-sm font-medium text-gray-900">
                              @if (standing.team) {
                                {{ getTeamDisplay(standing.team) }}
                              }
                            </td>
                            <td class="px-4 py-2 text-sm text-center text-gray-600">{{ standing.matches_played }}</td>
                            <td class="px-4 py-2 text-sm text-center text-green-600 font-medium">{{ standing.wins }}</td>
                            <td class="px-4 py-2 text-sm text-center text-red-600">{{ standing.losses }}</td>
                            <td class="px-4 py-2 text-sm text-center text-gray-600">{{ standing.sets_won }}-{{ standing.sets_lost }} ({{ getStandingsDiff(standing, 'sets') }})</td>
                            <td class="px-4 py-2 text-sm text-center text-gray-600">{{ standing.games_won }}-{{ standing.games_lost }} ({{ getStandingsDiff(standing, 'games') }})</td>
                            <td class="px-4 py-2 text-sm text-center font-bold text-gray-900">{{ standing.points }}</td>
                          </tr>
                        }
                      </tbody>
                    </table>
                  </div>
                </div>
              }
            } @else {
              <!-- General standings (round robin, single elimination, americano) -->
              <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                <table class="min-w-full divide-y divide-gray-200">
                  <thead class="bg-gray-50">
                    <tr>
                      <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Pos</th>
                      <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Equipa</th>
                      <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">J</th>
                      <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">V</th>
                      <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">D</th>
                      <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Sets</th>
                      <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Games</th>
                      <th class="px-4 py-2 text-center text-xs font-medium text-gray-500 uppercase">Pts</th>
                    </tr>
                  </thead>
                  <tbody class="divide-y divide-gray-200">
                    @for (standing of standings(); track standing.id; let i = $index) {
                      <tr class="hover:bg-gray-50">
                        <td class="px-4 py-2 text-sm text-gray-600">{{ i + 1 }}</td>
                        <td class="px-4 py-2 text-sm font-medium text-gray-900">
                          @if (standing.team) {
                            {{ getTeamDisplay(standing.team) }}
                          }
                        </td>
                        <td class="px-4 py-2 text-sm text-center text-gray-600">{{ standing.matches_played }}</td>
                        <td class="px-4 py-2 text-sm text-center text-green-600 font-medium">{{ standing.wins }}</td>
                        <td class="px-4 py-2 text-sm text-center text-red-600">{{ standing.losses }}</td>
                        <td class="px-4 py-2 text-sm text-center text-gray-600">{{ standing.sets_won }}-{{ standing.sets_lost }} ({{ getStandingsDiff(standing, 'sets') }})</td>
                        <td class="px-4 py-2 text-sm text-center text-gray-600">{{ standing.games_won }}-{{ standing.games_lost }} ({{ getStandingsDiff(standing, 'games') }})</td>
                        <td class="px-4 py-2 text-sm text-center font-bold text-gray-900">{{ standing.points }}</td>
                      </tr>
                    }
                  </tbody>
                </table>
              </div>
            }
          </div>
        }
      }

      <!-- BRACKET TAB -->
      @case ('bracket') {
        @if (bracketMatches().length === 0) {
          <div class="text-center py-8 text-gray-500">
            @if (tournament()!.status === 'registration' || tournament()!.status === 'draft') {
              O bracket sera gerado quando o torneio iniciar.
            } @else {
              Bracket nao disponivel.
            }
          </div>
        } @else {
          <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <app-bracket-tree
              [matches]="bracketMatches()"
              [thirdPlaceMatch]="tournament()!.settings.third_place_match" />
          </div>
        }
      }
    }
  </div>
}
